%define name    gst-plugins  
%define ver     0.3.02
%define rel     20011221
%define prefix  /usr
%define sysconfdir /etc

Summary: GStreamer Streaming-media framework plugins
Name: %name
Version: %ver
Release: %rel
Copyright: LGPL
Group: Libraries/Multimedia
Source: %{name}-%{ver}.tar.gz
BuildRoot: /var/tmp/%{name}-%{ver}-root
Docdir: %{prefix}/doc
Prefix: %prefix
Requires: libxml >= 1.8.0
BuildRequires: nasm => 0.90

%description
GStreamer is a streaming-media framework, based on graphs of filters which
operate on media data. Applications using this library can do anything
from real-time sound processing to playing videos, and just about anything
else media-related.  Its plugin-based architecture means that new data
types or processing capabilities can be added simply by installing new
plugins.

%files
%defattr(-, root, root)
%doc AUTHORS COPYING README  

%prep
%setup
%build
CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=%{prefix} --sysconfdir=%{sysconfdir} --mandir=$RPM_BUILD_ROOT%{prefix}/share/man  

if [ "$SMP" != "" ]; then
  (make "MAKE=make -k -j $SMP"; exit 0)
  make 2>&1 | tee make.log
else
  make 2>&1 | tee make.log
fi

%install
[ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT

make prefix=$RPM_BUILD_ROOT%{prefix} install

%clean
[ -n "$RPM_BUILD_ROOT" -a "$RPM_BUILD_ROOT" != / ] && rm -rf $RPM_BUILD_ROOT

### ESD ###
@USE_ESD_TRUE@%package -n gstreamer-esd
@USE_ESD_TRUE@Summary: Gstreamer plugin for ESD sound output
@USE_ESD_TRUE@Group: Libraries/Multimedia
@USE_ESD_TRUE@Requires: esound >= 0.2.8
@USE_ESD_TRUE@Requires: %{name} = %{ver}
@USE_ESD_TRUE@
@USE_ESD_TRUE@%description -n gstreamer-esd
@USE_ESD_TRUE@Output plugin for GStreamer for use with the esound package
@USE_ESD_TRUE@
@USE_ESD_TRUE@%files -n gstreamer-esd
@USE_ESD_TRUE@%defattr(-, root, root)
@USE_ESD_TRUE@%{prefix}/lib/gst/libesd*
@USE_ESD_TRUE@
@USE_ESD_TRUE@%post -n gstreamer-esd
@USE_ESD_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_ESD_TRUE@
@USE_ESD_TRUE@%postun -n gstreamer-esd
@USE_ESD_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_ESD_TRUE@/sbin/ldconfig

### MAD ###
@USE_MAD_TRUE@%package -n gstreamer-mad  
@USE_MAD_TRUE@Summary: Plugin using MAD for mp3 decoding
@USE_MAD_TRUE@Group: Libraries/Multimedia
@USE_MAD_TRUE@Requires: %{name} = %{ver}
@USE_MAD_TRUE@Requires: mad >= 0.13.0
@USE_MAD_TRUE@
@USE_MAD_TRUE@%description -n gstreamer-mad
@USE_MAD_TRUE@Plugin for playback of mp3 songs using the very good MAD library
@USE_MAD_TRUE@
@USE_MAD_TRUE@%files -n gstreamer-mad
@USE_MAD_TRUE@%defattr(-, root, root)  
@USE_MAD_TRUE@%{prefix}/lib/gst/libgstmad*
@USE_MAD_TRUE@
@USE_MAD_TRUE@%post -n gstreamer-mad
@USE_MAD_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_MAD_TRUE@
@USE_MAD_TRUE@%postun -n gstreamer-mad
@USE_MAD_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_MAD_TRUE@/sbin/ldconfig

### OSS ###
@USE_OSS_TRUE@%package -n gstreamer-oss
@USE_OSS_TRUE@Summary: Gstreamer plugins for input and output using OSS
@USE_OSS_TRUE@Group: Libraries/Multimedia
@USE_OSS_TRUE@Requires: %{name} = %{ver}
@USE_OSS_TRUE@
@USE_OSS_TRUE@%description -n gstreamer-oss 
@USE_OSS_TRUE@Plugins for output and input to the OpenSoundSytem audio
@USE_OSS_TRUE@drivers found in the Linux kernels or commercially available
@USE_OSS_TRUE@from OpenSound.
@USE_OSS_TRUE@
@USE_OSS_TRUE@%files -n gstreamer-oss
@USE_OSS_TRUE@%defattr(-, root, root)
@USE_OSS_TRUE@%{prefix}/lib/gst/libgstoss*
@USE_OSS_TRUE@
@USE_OSS_TRUE@%post -n gstreamer-oss
@USE_OSS_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_OSS_TRUE@
@USE_OSS_TRUE@%postun -n gstreamer-oss
@USE_OSS_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_OSS_TRUE@/sbin/ldconfig

### Vorbis ###
@USE_VORBIS_TRUE@%package -n gstreamer-vorbis
@USE_VORBIS_TRUE@Summary: Gstreamer plugin for encoding and decoding Ogg Vorbis audio files
@USE_VORBIS_TRUE@Group: Libraries/Multimedia
@USE_VORBIS_TRUE@Requires: libogg >= 1.0beta4
@USE_VORBIS_TRUE@Requires: libvorbis >= 1.0beta4
@USE_VORBIS_TRUE@Requires: %{name} = %{ver}
@USE_VORBIS_TRUE@
@USE_VORBIS_TRUE@%description -n gstreamer-vorbis
@USE_VORBIS_TRUE@Plugins for creating and playing Ogg Vorbis audio files.
@USE_VORBIS_TRUE@
@USE_VORBIS_TRUE@%files -n gstreamer-vorbis  
@USE_VORBIS_TRUE@%defattr(-, root, root)
@USE_VORBIS_TRUE@%{prefix}/lib/gst/libgstvorbis*
@USE_VORBIS_TRUE@
@USE_VORBIS_TRUE@%post -n gstreamer-vorbis
@USE_VORBIS_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_VORBIS_TRUE@
@USE_VORBIS_TRUE@%postun -n gstreamer-vorbis
@USE_VORBIS_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0
@USE_VORBIS_TRUE@/sbin/ldconfig

@USE_AALIB_TRUE@%package -n gstreamer-aalib
@USE_AALIB_TRUE@Summary: Gstreamer plugin for Ascii-art output
@USE_AALIB_TRUE@Group: Libraries/Multimedia
@USE_AALIB_TRUE@Requires: aalib >= 1.3
@USE_AALIB_TRUE@BuildRequires: aalib-devel >= 1.3
@USE_AALIB_TRUE@Requires: %{name} = %{ver}
@USE_AALIB_TRUE@
@USE_AALIB_TRUE@%description -n gstreamer-aalib
@USE_AALIB_TRUE@Plugin for viewing movies in Ascii-art using aalib library.
@USE_AALIB_TRUE@
@USE_AALIB_TRUE@%files -n gstreamer-aalib
@USE_AALIB_TRUE@%defattr(-, root, root)
@USE_AALIB_TRUE@%{prefix}/lib/gst/libaa*
@USE_AALIB_TRUE@
@USE_AALIB_TRUE@%post -n gstreamer-aalib
@USE_AALIB_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_AFS_TRUE@%package -n gstreamer-afs
@USE_AFS_TRUE@Summary: Gstreamer plugin audiofile support
@USE_AFS_TRUE@Group: Libraries/Multimedia
@USE_AFS_TRUE@Requires: %{name} = %{ver}
@USE_AFS_TRUE@Requires: audiofile >= 0.2.1
@USE_AFS_TRUE@
@USE_AFS_TRUE@%description -n gstreamer-afs
@USE_AFS_TRUE@Plugin for supporting reading and writing all files audiofile support
@USE_AFS_TRUE@
@USE_AFS_TRUE@%files -n gstreamer-afs
@USE_AFS_TRUE@%defattr(-, root, root)
@USE_AFS_TRUE@%{prefix}/lib/gst/libafs*
@USE_AFS_TRUE@
@USE_AFS_TRUE@%post -n  gstreamer-afs
@USE_AFS_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_AVIFILE_TRUE@£%package -n gstreamer-avi
@USE_AVIFILE_TRUE@Summary: Gstreamer plugin for AVI format movie playback
@USE_AVIFILE_TRUE@Group: Libraries/Multimedia
@USE_AVIFILE_TRUE@Requires: %{name} = %{ver}
@USE_AVIFILE_TRUE@Requires: avifile = 0.6.20011111DD
@USE_AVIFILE_TRUE@
@USE_AVIFILE_TRUE@%description -n gstreamer-avi
@USE_AVIFILE_TRUE@Plugins for playback of AVI format media files.
@USE_AVIFILE_TRUE@
@USE_AVIFILE_TRUE@%files -n gstreamer-avi
@USE_AVIFILE_TRUE@%defattr(-, root, root)
@USE_AVIFILE_TRUE@%{prefix}/lib/gst/libavi*
@USE_AVIFILE_TRUE@%{prefix}/lib/gst/libwin*
@USE_AVIFILE_TRUE@
@USE_AVIFILE_TRUE@%post -n gstreamer-avi
@USE_AVIFILE_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_CDPARANOIA_TRUE@%package -n gstreamer-cdparanoia
@USE_CDPARANOIA_TRUE@Summary: Gstreamer plugin for CD audio input using CDParanoia IV
@USE_CDPARANOIA_TRUE@Group: Libraries/Multimedia
@USE_CDPARANOIA_TRUE@Requires: cdparanoia >= alpha9.7
@USE_CDPARANOIA_TRUE@Requires: %{name} = %{ver}
@USE_CDPARANOIA_TRUE@BuildRequires: cdparanoia-devel >= alpha9.7
@USE_CDPARANOIA_TRUE@
@USE_CDPARANOIA_TRUE@%description -n gstreamer-cdparanoia
@USE_CDPARANOIA_TRUE@Plugin for ripping audio tracks using cdparanoia under GStreamer
@USE_CDPARANOIA_TRUE@
@USE_CDPARANOIA_TRUE@%files -n gstreamer-cdparanoia
@USE_CDPARANOIA_TRUE@%defattr(-, root, root)
@USE_CDPARANOIA_TRUE@%{prefix}/lib/gst/libcdparanoia*
@USE_CDPARANOIA_TRUE@
@USE_CDPARANOIA_TRUE@%post -n gstreamer-cdparanoia
@USE_CDPARANOIA_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_FLAC_TRUE@%package -n gstreamer-flac
@USE_FLAC_TRUE@Summary: Gstreamer plugin for FLAC lossless audio format
@USE_FLAC_TRUE@Group: Libraries/Multimedia
@USE_FLAC_TRUE@Requires: %{name} = %{ver}
@USE_FLAC_TRUE@
@USE_FLAC_TRUE@%description -n gstreamer-flac
@USE_FLAC_TRUE@Plugin for the free FLAC lossless audio format.
@USE_FLAC_TRUE@
@USE_FLAC_TRUE@%files -n gstreamer-flac
@USE_FLAC_TRUE@%defattr(-, root, root)
@USE_FLAC_TRUE@%{prefix}/lib/gst/libgstflac*
@USE_FLAC_TRUE@
@USE_FLAC_TRUE@%post -n gstreamer-flac
@USE_FLAC_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_GNOMEVFS_TRUE@%package -n gstreamer-gnomevfs
@USE_GNOMEVFS_TRUE@Summary: GStreamer plugins for GNOME VFS input and output
@USE_GNOMEVFS_TRUE@Group: Libraries/Multimedia
@USE_GNOMEVFS_TRUE@Requires: gnome-vfs > 1.0
@USE_GNOMEVFS_TRUE@Requires: %{name} = %{ver}
@USE_GNOMEVFS_TRUE@BuildRequires: gnome-vfs-devel > 1.0
@USE_GNOMEVFS_TRUE@
@USE_GNOMEVFS_TRUE@%description -n gstreamer-gnomevfs
@USE_GNOMEVFS_TRUE@Plugins for reading and writing through GNOME VFS.
@USE_GNOMEVFS_TRUE@
@USE_GNOMEVFS_TRUE@%files -n gstreamer-gnomevfs
@USE_GNOMEVFS_TRUE@%defattr(-, root, root)
@USE_GNOMEVFS_TRUE@%{prefix}/lib/gst/libgnomevfs*
@USE_GNOMEVFS_TRUE@
@USE_GNOMEVFS_TRUE@%post -n gstreamer-gnomevfs
@USE_GNOMEVFS_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_LIBGSM_TRUE@%package -n gstreamer-gsm
@USE_LIBGSM_TRUE@Summary: Gstreamer plugin for GSM lossy audio format
@USE_LIBGSM_TRUE@Group: Libraries/Multimedia
@USE_LIBGSM_TRUE@Requires: gsm >= 1.0.10
@USE_LIBGSM_TRUE@Requires: %{name} = %{ver}
@USE_LIBGSM_TRUE@
@USE_LIBGSM_TRUE@%description -n gstreamer-gsm
@USE_LIBGSM_TRUE@Output plugin for GStreamer to convert to GSM lossy audio format.
@USE_LIBGSM_TRUE@
@USE_LIBGSM_TRUE@%files -n gstreamer-gsm
@USE_LIBGSM_TRUE@%defattr(-, root, root)
@USE_LIBGSM_TRUE@%{prefix}/lib/gst/libgstgsm*
@USE_LIBGSM_TRUE@
@USE_LIBGSM_TRUE@%post -n gstreamer-gsm
@USE_LIBGSM_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_MPEG2DEC_TRUE@%package -n gstreamer-mpeg
@USE_MPEG2DEC_TRUE@Summary: GStreamer plugins for MPEG video playback and encoding
@USE_MPEG2DEC_TRUE@Group: Libraries/Multimedia
@USE_MPEG2DEC_TRUE@Requires: %{name} = %{ver}
@USE_MPEG2DEC_TRUE@Requires: mpeg2dec => 0.2.0
@USE_MPEG2DEC_TRUE@Obsoletes: gstreamer-mpeg1
@USE_MPEG2DEC_TRUE@Obsoletes: gstreamer-mpeg2
@USE_MPEG2DEC_TRUE@
@USE_MPEG2DEC_TRUE@%description -n gstreamer-mpeg
@USE_MPEG2DEC_TRUE@Plugins for playing and encoding MPEG video
@USE_MPEG2DEC_TRUE@
@USE_MPEG2DEC_TRUE@%files -n gstreamer-mpeg
@USE_MPEG2DEC_TRUE@%defattr(-, root, root)
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpeg1types*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpeg1encoder*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpegaudio*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmp1*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpegstream*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpeg2play*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpeg2enc*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmpeg2subt*
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libmp2videoparse*
@USE_MPEG2DEC_TRUE@
@USE_MPEG2DEC_TRUE@%post -n  gstreamer-mpeg
@USE_MPEG2DEC_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_MPEG2DEC_TRUE@%package -n gstreamer-mpeg2dec
@USE_MPEG2DEC_TRUE@Summary: GStreamer plugins for Mpeg level 2 playback
@USE_MPEG2DEC_TRUE@Group: Libraries/Multimedia
@USE_MPEG2DEC_TRUE@Requires: %{name} = %{ver}
@USE_MPEG2DEC_TRUE@Requires: mpeg2dec >= 0.2.0
@USE_MPEG2DEC_TRUE@
@USE_MPEG2DEC_TRUE@%description -n gstreamer-mpeg2dec
@USE_MPEG2DEC_TRUE@Plugins for playing mpeg level 2 encoded movies
@USE_MPEG2DEC_TRUE@
@USE_MPEG2DEC_TRUE@%files -n gstreamer-mpeg2dec
@USE_MPEG2DEC_TRUE@%defattr(-, root, root)
@USE_MPEG2DEC_TRUE@%{prefix}/lib/gst/libgstmpeg2dec*
@USE_MPEG2DEC_TRUE@
@USE_MPEG2DEC_TRUE@%post -n  gstreamer-mpeg2dec
@USE_MPEG2DEC_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

@USE_LIBSDL_TRUE@%package -n gstreamer-sdl
@USE_LIBSDL_TRUE@Summary: Gstreamer plugin for outputing to SDL
@USE_LIBSDL_TRUE@Group: Libraries/Multimedia
@USE_LIBSDL_TRUE@Requires: SDL >= 1.2.0
@USE_LIBSDL_TRUE@Requires: %{name} = %{ver}
@USE_LIBSDL_TRUE@BuildRequires: SDL-devel >= 1.2.0
@USE_LIBSDL_TRUE@
@USE_LIBSDL_TRUE@%description -n gstreamer-sdl
@USE_LIBSDL_TRUE@Plugin for sending output to the Simple Direct Media architecture.
@USE_LIBSDL_TRUE@(http://www.libsdl.org). Usefull for fullscreen playback.
@USE_LIBSDL_TRUE@
@USE_LIBSDL_TRUE@%files -n gstreamer-sdl
@USE_LIBSDL_TRUE@%defattr(-, root, root)
@USE_LIBSDL_TRUE@%{prefix}/lib/gst/libsdl*
@USE_LIBSDL_TRUE@
@USE_LIBSDL_TRUE@%post -n gstreamer-sdl
@USE_LIBSDL_TRUE@%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-ladspa
Summary: Gstreamer wrapper for LADSPA plugins
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%files -n gstreamer-ladspa
%defattr(-, root, root)
%{prefix}/lib/gst/libgstladspa*

%description -n gstreamer-ladspa
Plugin which wraps LADSPA plugins for use by GStreamer applications.

%post -n gstreamer-ladspa
%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-udp
Summary: Gstreamer pluginis for UDP tranport
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%description -n gstreamer-udp
Plugins for UDP transport

%files -n gstreamer-udp
%defattr(-, root, root)
%{prefix}/lib/gst/libgstudp*

%post -n gstreamer-udp
%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-mp3
Summary: GStreamer plugins for mp3 playback
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%description -n gstreamer-mp3
Plugins for decoding mp3 files. We do recommend you
use Ogg Vorbis format instead however since it is both unencumbered by patents
and better.

%files -n gstreamer-mp3
%defattr(-, root, root)
%{prefix}/lib/gst/libmpg123*
%{prefix}/lib/gst/libmp3parse*
%{prefix}/lib/gst/libmp3types*

%post -n  gstreamer-mp3
%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-flx
Summary: Gstreamer plugin for FLI/FLX animation format
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%description -n gstreamer-flx
Plugin for playing FLI/FLX animations under GStreamer

%files -n gstreamer-flx
%defattr(-, root, root)
%{prefix}/lib/gst/libflx*

%post -n gstreamer-flx
%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-deinterlace
Summary: GStreamer Video deinterlacer
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%description -n gstreamer-deinterlace
Video deinterlace plugin

%files -n gstreamer-deinterlace
%defattr(-, root, root)
%{prefix}/lib/gst/libdeinterlace*

%post -n gstreamer-deinterlace
%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-festival
Summary: GStreamer plugin for text-to-speech support using Festival
Group: Libraries/Multimedia
Requires: %{name} = %{ver}
Requires: festival >= 1.4.1

%description -n gstreamer-festival
Element for text-to-speech using the festival server.

%files -n gstreamer-festival
%defattr(-, root, root)
%{prefix}/lib/gst/libgstfestival*

%post -n gstreamer-festival
%{prefix}/bin/gstreamer-register --gst-mask=0

%package -n gstreamer-chart
Summary: GStreamer plugin for converting audio into video
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%description -n gstreamer-chart
Plugin for converting audio into video

%files -n gstreamer-chart
%defattr(-, root, root)
%{prefix}/lib/gst/libchart*
%package -n gstreamer-visualisation
Summary: Gstreamer visualisations plugins
Group: Libraries/Multimedia
Requires: %{name} = %{ver}

%description -n gstreamer-visualisation
Various plugins for visual effects to use with audio. Included are Smoothwave, Spectrum and vumeter

%files -n gstreamer-visualisation
%defattr(-, root, root)
%{prefix}/lib/gst/libsmooth*
%{prefix}/lib/gst/libgstspectrum*
%{prefix}/lib/gst/libvu*

